<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººç‰©ç¸½è¦½ - ã€Šä¿®ä»™-ä¸ƒç„é—œã€‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-[#A36B4F]">ã€Šä¿®ä»™-ä¸ƒç„é—œã€‹</h1>
            <p class="text-lg text-gray-600 mt-2">äººç‰©ç¸½è¦½</p>
        </header>

        <!-- é¡µé¢å¯¼èˆª -->
        <nav class="page-nav">
            <a href="index.html">ğŸ  é¦–é¡µ</a>
            <a href="overview.html" class="active">ğŸ‘¥ äººç‰©ç¸½è¦½</a>
            <a href="relations.html">ğŸ•¸ï¸ é—œä¿‚ç¶²çµ¡</a>
            <a href="structure.html">ğŸ“Š é—œä¿‚åœ–</a>
            <a href="chapters.html">ğŸ“– ç« ç¯€å¤§ç¶±</a>
            <a href="antagonists.html">âš”ï¸ åæ´¾å‰–æ</a>
            <a href="story.html">ğŸ“š æ•…äº‹å…§å®¹</a>
        </nav>

        <main>
            <div class="text-center mb-8 max-w-3xl mx-auto">
                <h2 class="text-2xl font-bold text-[#ffffff] mb-2">äººç‰©ç¸½è¦½</h2>
                <p class="text-white-600">
                    é»æ“Šä¸‹æ–¹çš„äººç‰©å¡ç‰‡ï¼Œå¯ä»¥æ·±å…¥äº†è§£æ¯å€‹è§’è‰²çš„è©³ç´°èƒŒæ™¯ã€å¿ƒç†ç‹€æ…‹èˆ‡äººéš›é—œä¿‚ã€‚é€™å€‹ç¸½è¦½èƒ½å¹«åŠ©æ‚¨å¿«é€ŸæŒæ¡æ•…äº‹ä¸­çš„ä¸»è¦åƒèˆ‡è€…ã€‚
                </p>
            </div>
            <div id="character-grid"></div>
        </main>
    </div>

    <!-- Modal -->
    <div id="character-modal" class="fixed inset-0 w-full h-full z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="bg-[#FDFBF8] rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto relative" id="modal-content">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <script src="data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const characterGrid = document.getElementById('character-grid');
            const modal = document.getElementById('character-modal');
            const modalContent = document.getElementById('modal-content');

            // è§’è‰²é ­åƒå°æ‡‰ï¼ˆå‡è¨­é †åº c1~c8 å°æ‡‰ä¸»è§’èˆ‡åæ´¾ï¼‰
            const imageMap = {
                'lin-chengyou': 'img/c1.png',
                'gu-mingxuan': 'img/c2.png',
                'jiang-xueyin': 'img/c3.png',
                'xu-youzhe': 'img/c4.png',
                'liu-yuantang': 'img/c5.png',
                'xu-baiting': 'img/c6.png',
                'huang-ruizhang': 'img/c7.png',
                'zhou-zixun': 'img/c8.png'
            };

            function getCharacterImage(char) {
                return imageMap[char.id] || '';
            }
 
            function createCharacterCard(char, group) {
                const isSupporting = group === 'supporting';
                const img = getCharacterImage(char);
                const avatarHtml = img
                  ? `<img src="${img}" alt="${char.name}" loading="lazy" class="w-[200px] h-[200px] rounded-full object-cover mb-4 shadow ring-2 ring-[#E0DACE]" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">`
                  : '';
                const emojiFallback = `<div class="mb-4" style="${img ? 'display:none;' : ''}"><span class="inline-block text-[120px] leading-none">${char.emoji || 'ğŸ‘¥'}</span></div>`;
                return `
                    <div class="card-dark rounded-lg p-6 hover:-translate-y-1 transition-all duration-300 cursor-pointer flex flex-col items-center text-center h-full" ${!isSupporting ? `onclick="openModal('${char.id}', '${group}')"` : ''}>
                        ${avatarHtml}
                        ${emojiFallback}
                        <h3 class="font-bold text-lg card-title">${char.name}</h3>
                        <p class="text-sm card-subtitle">${char.role}</p>
                    </div>
                `;
            }
            
            function createSection(title, characters, group) {
                 return `
                    <div class="mb-12">
                        <h3 class="text-xl font-semibold mb-6 text-center text-[#A36B4F] border-b-2 border-[#E0DACE] pb-2">${title}</h3>
                        <div class="overflow-x-auto">
                            <div class="grid grid-cols-4 gap-8 min-w-[960px]">
                                ${characters.slice(0, 4).map(char => createCharacterCard(char, group)).join('')}
                            </div>
                        </div>
                    </div>
                 `;
            }
            
            characterGrid.innerHTML = createSection('ä¸»è§’ç¾¤', characters.protagonists, 'protagonists') +
                                      createSection('åæ´¾ç¾¤', characters.antagonists, 'antagonists') +
                                      createSection('é…è§’ç¾¤', characters.supporting, 'supporting');
            
            window.openModal = (charId, group) => {
                const character = characters[group].find(c => c.id === charId);
                if (!character) return;

                let contentHtml = `
                    <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl z-10">&times;</button>
                    <div class="p-6 md:p-8">
                        <div class="text-center mb-6">
                            ${getCharacterImage(character) ? `<img src=\"${getCharacterImage(character)}\" alt=\"${character.name}\" class=\"w-[320px] h-[320px] rounded-full object-cover mx-auto mb-4 shadow ring-2 ring-[#E0DACE]\" onerror=\"this.style.display='none'; document.getElementById('emoji-fallback').style.display='inline-block';\">` : ''}
                            <span id="emoji-fallback" class="text-[160px] leading-none" style="${getCharacterImage(character) ? 'display:none;' : ''}">${character.emoji || 'ğŸ‘¥'}</span>
                            <h2 class="text-3xl font-bold mt-2">${character.name}</h2>
                            <p class="text-gray-600">${character.role}</p>
                        </div>
                        <div class="space-y-4 text-left">
                `;
                
                const fieldMap = {
                    'å€‹æ€§': character.personality, 'å¤–å‹': character.appearance, 'å¹´é½¡': character.age,
                    'èƒŒæ™¯': character.background, 'å‹•æ©Ÿ': character.motivation, 'å¿ƒç†å¼§ç·š': character.arc,
                    'å°ˆé•·': character.skills, 'ç¼ºé»': character.flaws, 'äº’å‹•é—œä¿‚': character.relations
                };

                for(const [label, value] of Object.entries(fieldMap)) {
                    if(value) {
                        contentHtml += `<div class="border-t border-gray-200 pt-3"><strong class="text-[#A36B4F]">${label}ï¼š</strong>`;
                        if(Array.isArray(value)) {
                            contentHtml += `<ul class="list-disc list-inside mt-1 text-gray-700">`;
                            value.forEach(item => contentHtml += `<li>${item}</li>`);
                            contentHtml += `</ul>`;
                        } else {
                            contentHtml += `<span class="text-gray-700">${value}</span>`;
                        }
                        contentHtml += `</div>`;
                    }
                }
                
                contentHtml += `</div></div>`;
                modalContent.innerHTML = contentHtml;
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            };

            window.closeModal = () => {
                modal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            };

            modal.addEventListener('click', (e) => {
                if(e.target === modal) {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>
